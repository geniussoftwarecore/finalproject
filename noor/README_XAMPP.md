# دليل تثبيت نظام إدارة المستخدمين على XAMPP

## 🛡️ تنبيه أمني مهم

> **⚠️ نقطة الدخول الصحيحة: `/public` فقط**
> 
> - **يجب** الوصول إلى التطبيق من خلال مجلد `public/` فقط
> - الرابط الصحيح: `http://localhost/noor/public`
> - **لا تحاول** الوصول مباشرة إلى `http://localhost/noor`
> 
> **لماذا هذا مهم؟**
> - مجلد `public/` هو نقطة الدخول الآمنة الوحيدة للتطبيق
> - المجلدات الأخرى (`app/`, `admin/`, `api/`, `auth/`) محمية من الوصول المباشر
> - هذه البنية الأمنية تحمي ملفات التكوين وقاعدة البيانات والملفات الحساسة
> - محاولة الوصول من المجلد الجذري ستوجهك تلقائياً إلى `public/` مع رسالة تحذيرية

---

## 📋 المتطلبات الأساسية

قبل البدء في التثبيت، تأكد من توفر المتطلبات التالية:

### متطلبات البرامج
- **XAMPP** الإصدار 7.4 أو أحدث
  - يمكن تحميله من: [https://www.apachefriends.org](https://www.apachefriends.org)
- **PHP** 7.4 أو أحدث (مضمن مع XAMPP)
- **MySQL** 5.7 أو أحدث (مضمن مع XAMPP)
- **متصفح ويب حديث** (Chrome، Firefox، Edge، Safari)

### الإضافات المطلوبة لـ PHP
تأكد من تفعيل الإضافات التالية في ملف `php.ini`:
- `extension=pdo_mysql`
- `extension=mbstring`
- `extension=openssl`
- `extension=curl`

---

## 📥 خطوات التثبيت

### الخطوة 1: تحميل المشروع

1. قم بتحميل ملفات المشروع
2. انسخ مجلد `noor` إلى مجلد `htdocs` في XAMPP
   - المسار الافتراضي لـ Windows: `C:\xampp\htdocs\`
   - المسار الافتراضي لـ macOS: `/Applications/XAMPP/htdocs/`
   - المسار الافتراضي لـ Linux: `/opt/lampp/htdocs/`

### الخطوة 2: تشغيل XAMPP

1. افتح لوحة التحكم في XAMPP (XAMPP Control Panel)
2. قم بتشغيل الخدمات التالية:
   - **Apache** - اضغط على زر "Start" بجانب Apache
   - **MySQL** - اضغط على زر "Start" بجانب MySQL
3. تأكد من أن كلا الخدمتين تعمل (ستظهر باللون الأخضر)

### الخطوة 3: إنشاء قاعدة البيانات

1. افتح متصفح الويب وانتقل إلى: [http://localhost/phpmyadmin](http://localhost/phpmyadmin)
2. انقر على تبويب "SQL" في القائمة العلوية
3. افتح ملف `db.sql` الموجود في مجلد المشروع باستخدام محرر نصوص
4. انسخ محتوى الملف بالكامل
5. الصق المحتوى في حقل SQL في phpMyAdmin
6. انقر على زر "تنفيذ" أو "Go"
7. تأكد من إنشاء قاعدة البيانات `project_db` والجداول بنجاح

#### ملاحظة مهمة
- سيتم إنشاء مستخدم مدير افتراضي بالبيانات التالية:
  - **اسم المستخدم:** admin
  - **كلمة المرور:** password
  - **البريد الإلكتروني:** admin@gmail.com
- **يجب تغيير كلمة المرور فوراً بعد التثبيت لأسباب أمنية!**

### الخطوة 4: إعداد ملف التكوين

1. انتقل إلى مجلد `noor/app/config/`
2. افتح ملف `config.php` باستخدام محرر نصوص (مثل Notepad++، VSCode، Sublime Text)
3. تحقق من الإعدادات التالية (يجب أن تكون صحيحة بشكل افتراضي):

```php
define('DB_HOST', 'localhost');
define('DB_NAME', 'project_db');
define('DB_USER', 'root');
define('DB_PASS', '');
define('DB_CHARSET', 'utf8mb4');
```

4. إذا كنت قد غيرت إعدادات MySQL في XAMPP، قم بتحديث البيانات وفقاً لذلك

### الخطوة 5: التحقق من الترميز UTF-8

تأكد من أن جميع الملفات محفوظة بترميز UTF-8:
1. في محرر النصوص، تحقق من ترميز الملفات
2. إذا لزم الأمر، احفظ الملفات بترميز UTF-8 (بدون BOM)

---

## 🔐 إعداد Google reCAPTCHA (اختياري)

المشروع يستخدم مفاتيح reCAPTCHA الاختبارية بشكل افتراضي. للحصول على الحماية الكاملة في بيئة الإنتاج:

### الخطوة 1: الحصول على مفاتيح reCAPTCHA

1. انتقل إلى [https://www.google.com/recaptcha/admin](https://www.google.com/recaptcha/admin)
2. سجل دخول بحساب Google الخاص بك
3. انقر على "إنشاء" لإضافة موقع جديد
4. املأ البيانات:
   - **التسمية:** اسم مشروعك
   - **نوع reCAPTCHA:** اختر v2 "أنا لست روبوت"
   - **النطاقات:** أضف `localhost` للتطوير، ونطاق موقعك للإنتاج
5. انقر على "إرسال"
6. ستحصل على مفتاحين:
   - **مفتاح الموقع (Site Key)**
   - **المفتاح السري (Secret Key)**

### الخطوة 2: تحديث ملف التكوين

1. افتح ملف `noor/app/config/config.php`
2. ابحث عن السطور التالية:

```php
define('RECAPTCHA_SITE_KEY', '6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI');
define('RECAPTCHA_SECRET_KEY', '6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe');
```

3. استبدل القيم بمفاتيحك الحقيقية:

```php
define('RECAPTCHA_SITE_KEY', 'مفتاح_الموقع_الخاص_بك');
define('RECAPTCHA_SECRET_KEY', 'المفتاح_السري_الخاص_بك');
```

4. احفظ الملف

---

## 🚀 تشغيل التطبيق

بعد إتمام جميع الخطوات السابقة:

1. افتح متصفح الويب
2. **انتقل إلى نقطة الدخول الصحيحة:** [http://localhost/noor/public](http://localhost/noor/public)
3. يجب أن تظهر صفحة تسجيل الدخول

> **🔐 ملاحظة أمنية هامة:**
> - استخدم دائماً الرابط: `http://localhost/noor/public`
> - إذا حاولت الوصول إلى `http://localhost/noor` ستظهر رسالة تحذيرية وسيتم توجيهك تلقائياً
> - هذا يضمن أن جميع الملفات الحساسة محمية من الوصول المباشر

### تسجيل الدخول لأول مرة

استخدم بيانات المدير الافتراضية:
- **اسم المستخدم:** admin
- **كلمة المرور:** password

**تحذير أمني:** قم بتغيير كلمة المرور فوراً بعد أول تسجيل دخول!

---

## 🔧 استكشاف الأخطاء الشائعة

### 1. خطأ "خطأ في الاتصال بقاعدة البيانات"

**الأسباب المحتملة:**
- خدمة MySQL غير مشغلة في XAMPP
- اسم قاعدة البيانات غير صحيح
- بيانات الاعتماد في ملف التكوين غير صحيحة

**الحلول:**
1. تأكد من تشغيل MySQL في لوحة تحكم XAMPP
2. تحقق من وجود قاعدة بيانات `project_db` في phpMyAdmin
3. راجع إعدادات قاعدة البيانات في ملف `config.php`
4. تأكد من أن اسم المستخدم `root` وكلمة المرور فارغة (افتراضي في XAMPP)

### 2. الأحرف العربية تظهر بشكل خاطئ (؟؟؟ أو ####)

**الأسباب المحتملة:**
- ترميز الملفات ليس UTF-8
- ترميز قاعدة البيانات غير صحيح

**الحلول:**
1. تأكد من حفظ جميع ملفات PHP بترميز UTF-8
2. في phpMyAdmin، تحقق من أن الترتيب (Collation) لقاعدة البيانات هو `utf8mb4_unicode_ci`
3. أعد استيراد ملف `db.sql` إذا لزم الأمر

### 3. خطأ 404 - الصفحة غير موجودة

**الأسباب المحتملة:**
- المسار غير صحيح
- ملفات المشروع في مكان خاطئ

**الحلول:**
1. تأكد من أن مجلد `noor` موجود في `htdocs`
2. تحقق من الرابط: يجب أن يكون `http://localhost/noor/public`
3. تأكد من وجود ملف `index.php` في مجلد `public`

### 4. خطأ 403 - محظور الوصول

**الأسباب المحتملة:**
- ملف `.htaccess` يمنع الوصول
- إعدادات Apache غير صحيحة

**الحلول:**
1. تحقق من ملف `.htaccess` في مجلد `public`
2. تأكد من تفعيل `mod_rewrite` في Apache
3. في ملف `httpd.conf`، تأكد من أن `AllowOverride` مضبوط على `All`

### 5. reCAPTCHA لا يعمل

**الأسباب المحتملة:**
- مفاتيح reCAPTCHA غير صحيحة
- انقطاع الإنترنت

**الحلول:**
1. استخدم مفاتيح الاختبار الافتراضية للتطوير المحلي (مضمنة في المشروع)
2. تأكد من اتصالك بالإنترنت (reCAPTCHA يتطلب الاتصال)
3. راجع المفاتيح في ملف `config.php`

### 6. خطأ في الجلسة (Session)

**الأسباب المحتملة:**
- مجلد الجلسات غير قابل للكتابة
- إعدادات PHP غير صحيحة

**الحلول:**
1. تحقق من أن مجلد `tmp` في XAMPP قابل للكتابة
2. في ملف `php.ini`، تأكد من صحة `session.save_path`
3. أعد تشغيل Apache من لوحة تحكم XAMPP

---

## 📁 هيكل المشروع

```
noor/
├── app/
│   ├── config/
│   │   ├── config.php          # ملف الإعدادات الرئيسي (MySQL)
│   │   └── config.example.php  # نموذج ملف الإعدادات
│   ├── lib/
│   │   ├── auth.php            # مكتبة المصادقة
│   │   ├── captcha.php         # مكتبة reCAPTCHA
│   │   └── validation.php      # مكتبة التحقق من البيانات
│   └── models/
│       └── UserModel.php       # نموذج المستخدم
├── public/                     # المجلد العام (نقطة الدخول)
│   ├── assets/
│   │   ├── css/
│   │   └── js/
│   ├── errors/
│   │   ├── 403.php
│   │   └── 404.php
│   ├── .htaccess              # قواعد الحماية
│   ├── index.php              # الصفحة الرئيسية
│   ├── login.php              # صفحة تسجيل الدخول
│   ├── dashboard.php          # لوحة التحكم
│   ├── profile.php            # الملف الشخصي
│   └── logout.php             # تسجيل الخروج
├── admin/
│   └── admin.php              # لوحة تحكم المدير
├── db.sql                     # ملف قاعدة البيانات
├── .gitignore
└── README_XAMPP.md            # هذا الملف
```

---

## 🔒 ملاحظات أمنية مهمة

### 🛡️ حماية نقطة الدخول (الأهم)
1. **استخدام `/public` فقط:**
   - **يجب** الوصول للتطبيق من `http://localhost/noor/public` فقط
   - المجلد الجذري `http://localhost/noor` محمي وسيعيد التوجيه
   - جميع المجلدات الحساسة (`app/`, `admin/`, `api/`, `auth/`) محمية من الوصول المباشر
   - ملف `.htaccess` في المجلد الجذري يوفر طبقة حماية إضافية

### 🔐 الأمان العام
2. **تغيير كلمة مرور المدير:**
   - قم بتغيير كلمة مرور حساب المدير الافتراضي فوراً
   - استخدم كلمة مرور قوية (حروف كبيرة وصغيرة + أرقام + رموز)

3. **حماية ملف التكوين:**
   - ملف `config.php` محمي بواسطة `.htaccess`
   - لا تشارك ملف `config.php` في المستودعات العامة
   - استخدم `config.example.php` كنموذج للمشاركة

4. **تحديث reCAPTCHA:**
   - استبدل مفاتيح الاختبار بمفاتيح حقيقية في الإنتاج
   - لا تشارك المفتاح السري مع أحد

5. **النسخ الاحتياطي:**
   - قم بعمل نسخة احتياطية من قاعدة البيانات بانتظام
   - احتفظ بنسخة من ملف `config.php` في مكان آمن

6. **تحديثات الأمان:**
   - حافظ على تحديث XAMPP/PHP/MySQL
   - راجع سجلات الأخطاء بانتظام

---

## 📞 الدعم والمساعدة

إذا واجهت أي مشاكل أو لديك أسئلة:

1. راجع قسم "استكشاف الأخطاء الشائعة" أعلاه
2. تحقق من سجلات الأخطاء في XAMPP:
   - Windows: `C:\xampp\apache\logs\error.log`
   - macOS/Linux: `/opt/lampp/logs/error.log`
3. تأكد من اتباع جميع الخطوات بالترتيب

---

## ✅ قائمة التحقق السريعة

- [ ] تم تثبيت XAMPP
- [ ] تم نسخ المشروع إلى `htdocs/noor`
- [ ] Apache و MySQL يعملان في لوحة تحكم XAMPP
- [ ] تم إنشاء قاعدة البيانات `project_db` باستخدام `db.sql`
- [ ] تم التحقق من إعدادات `config.php`
- [ ] تم فتح المشروع على `http://localhost/noor/public`
- [ ] تم تسجيل الدخول بحساب المدير الافتراضي
- [ ] تم تغيير كلمة مرور المدير
- [ ] (اختياري) تم تحديث مفاتيح reCAPTCHA

---

## 📄 الترخيص

هذا المشروع تعليمي ومفتوح المصدر.

---

**ملاحظة أخيرة:** هذا الدليل مخصص لبيئة التطوير المحلية باستخدام XAMPP. للنشر على خادم إنتاج، يجب اتخاذ إجراءات أمنية إضافية وتكوينات خاصة بالخادم.

**تاريخ آخر تحديث:** 1 أكتوبر 2025  
**الإصدار:** 1.0.0
